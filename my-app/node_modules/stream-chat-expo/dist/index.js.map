{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["/**\n * In Expo 34, all the modules such as image picker, document picker, permissions etc etc have been moved to their own packages.\n * And they have been removed from Expo package. But these packages don't work with Expo 32 sdk (because of linking issue).\n */\nimport { registerNativeHandlers } from 'stream-chat-react-native-core';\nimport NetInfo from '@react-native-community/netinfo';\nimport { Constants } from 'react-native-unimodules';\nimport * as Expo from 'expo';\n\nlet ImagePicker;\nlet DocumentPicker;\nlet Permissions;\nlet manifest = {};\n\nmanifest = Constants.manifest;\nif (!manifest) {\n  manifest = Expo.Constants.manifest;\n}\n\nif (manifest.sdkVersion.split('.')[0] >= 33) {\n  ImagePicker = require('expo-image-picker');\n  Permissions = require('expo-permissions');\n  DocumentPicker = require('expo-document-picker');\n} else {\n  ImagePicker = Expo.ImagePicker;\n  Permissions = Expo.Permissions;\n  DocumentPicker = Expo.DocumentPicker;\n}\n\nregisterNativeHandlers({\n  NetInfo: {\n    addEventListener(listener) {\n      let unsubscribe;\n      // For NetInfo >= 3.x.x\n      if (NetInfo.fetch && typeof NetInfo.fetch === 'function') {\n        unsubscribe = NetInfo.addEventListener(({ isConnected }) => {\n          listener(isConnected);\n        });\n        return unsubscribe;\n      } else {\n        // For NetInfo < 3.x.x\n        unsubscribe = NetInfo.addEventListener('connectionChange', () => {\n          NetInfo.isConnected.fetch().then((isConnected) => {\n            listener(isConnected);\n          });\n        });\n\n        return unsubscribe.remove;\n      }\n    },\n\n    fetch() {\n      return new Promise((resolve, reject) => {\n        // For NetInfo >= 3.x.x\n        if (NetInfo.fetch && typeof NetInfo.fetch === 'function') {\n          NetInfo.fetch().then(({ isConnected }) => {\n            resolve(isConnected);\n          }, reject);\n        } else {\n          // For NetInfo < 3.x.x\n          NetInfo.isConnected.fetch().then((isConnected) => {\n            resolve(isConnected);\n          }, reject);\n        }\n      });\n    },\n  },\n  pickImage: async () => {\n    await Permissions.askAsync(Permissions.CAMERA_ROLL);\n\n    return await ImagePicker.launchImageLibraryAsync({\n      allowsEditing: false,\n      aspect: [4, 3],\n      //TODO: Decide what to do about it\n      quality: 0.2,\n    });\n  },\n  pickDocument: async () => await DocumentPicker.getDocumentAsync(),\n});\n\nexport * from 'stream-chat-react-native-core';\n"],"names":["ImagePicker","DocumentPicker","Permissions","manifest","Constants","Expo","sdkVersion","split","require","registerNativeHandlers","NetInfo","addEventListener","listener","unsubscribe","fetch","isConnected","then","remove","Promise","resolve","reject","pickImage","askAsync","CAMERA_ROLL","launchImageLibraryAsync","allowsEditing","aspect","quality","pickDocument","getDocumentAsync"],"mappings":";;;;;;;;;;;AAAA;;;;AAIA,AAKA,IAAIA,WAAJ;AACA,IAAIC,cAAJ;AACA,IAAIC,WAAJ;AACA,IAAIC,QAAQ,GAAG,EAAf;AAEAA,QAAQ,GAAGC,+BAAS,CAACD,QAArB;;AACA,IAAI,CAACA,QAAL,EAAe;EACbA,QAAQ,GAAGE,cAAA,CAAeF,QAA1B;;;AAGF,IAAIA,QAAQ,CAACG,UAAT,CAAoBC,KAApB,CAA0B,GAA1B,EAA+B,CAA/B,KAAqC,EAAzC,EAA6C;EAC3CP,WAAW,GAAGQ,OAAO,CAAC,mBAAD,CAArB;EACAN,WAAW,GAAGM,OAAO,CAAC,kBAAD,CAArB;EACAP,cAAc,GAAGO,OAAO,CAAC,sBAAD,CAAxB;CAHF,MAIO;EACLR,WAAW,GAAGK,gBAAd;EACAH,WAAW,GAAGG,gBAAd;EACAJ,cAAc,GAAGI,mBAAjB;;;AAGFI,gDAAsB,CAAC;EACrBC,OAAO,EAAE;IACPC,gBAAgB,CAACC,QAAD,EAAW;UACrBC,WAAJ,CADyB;;UAGrBH,OAAO,CAACI,KAAR,IAAiB,OAAOJ,OAAO,CAACI,KAAf,KAAyB,UAA9C,EAA0D;QACxDD,WAAW,GAAGH,OAAO,CAACC,gBAAR,CAAyB,CAAC;UAAEI;SAAH,KAAqB;UAC1DH,QAAQ,CAACG,WAAD,CAAR;SADY,CAAd;eAGOF,WAAP;OAJF,MAKO;;QAELA,WAAW,GAAGH,OAAO,CAACC,gBAAR,CAAyB,kBAAzB,EAA6C,MAAM;UAC/DD,OAAO,CAACK,WAAR,CAAoBD,KAApB,GAA4BE,IAA5B,CAAkCD,WAAD,IAAiB;YAChDH,QAAQ,CAACG,WAAD,CAAR;WADF;SADY,CAAd;eAMOF,WAAW,CAACI,MAAnB;;KAjBG;;IAqBPH,KAAK,GAAG;aACC,IAAII,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;;YAElCV,OAAO,CAACI,KAAR,IAAiB,OAAOJ,OAAO,CAACI,KAAf,KAAyB,UAA9C,EAA0D;UACxDJ,OAAO,CAACI,KAAR,GAAgBE,IAAhB,CAAqB,CAAC;YAAED;WAAH,KAAqB;YACxCI,OAAO,CAACJ,WAAD,CAAP;WADF,EAEGK,MAFH;SADF,MAIO;;UAELV,OAAO,CAACK,WAAR,CAAoBD,KAApB,GAA4BE,IAA5B,CAAkCD,WAAD,IAAiB;YAChDI,OAAO,CAACJ,WAAD,CAAP;WADF,EAEGK,MAFH;;OARG,CAAP;;;GAvBiB;EAsCrBC,SAAS,EAAE,YAAY;UACfnB,WAAW,CAACoB,QAAZ,CAAqBpB,WAAW,CAACqB,WAAjC,CAAN;WAEO,MAAMvB,WAAW,CAACwB,uBAAZ,CAAoC;MAC/CC,aAAa,EAAE,KADgC;MAE/CC,MAAM,EAAE,CAAC,CAAD,EAAI,CAAJ,CAFuC;;MAI/CC,OAAO,EAAE;KAJE,CAAb;GAzCmB;EAgDrBC,YAAY,EAAE,YAAY,MAAM3B,cAAc,CAAC4B,gBAAf;CAhDZ,CAAtB;;;;"}